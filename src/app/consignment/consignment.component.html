<div class="wrapper">

  <ul class="nav nav-tabs nav-justified">
    <li><a href="./consignments">Browse Consignment</a></li>
    <li class="active"><a href="#">Add New Consignment</a></li>
  </ul>
  <div>
    <form name="myForm" class="">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">General Information</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-2">
              <div class="form-group">
                <app-select-cons-direction [(direction)]="consignment.direction"></app-select-cons-direction>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <button [hidden]="consignment.direction !== 'Export'" (click)="showOrderModal()">+Link Order</button>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label [hidden]="consignment.direction !== 'Export'">Order Id: {{ order == null ? '' :
                 order.id }}</label>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group relative">
                <app-select-contractor [(contractor)]="consignment.goodsHolder" contractorType="Goods holder"
                                       [hidden]="consignment.direction === 'Import' || consignment.direction == ''"></app-select-contractor>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group relative">
                <app-select-contractor contractorType="Cost payer"
                                       [(contractor)]="consignment.costPayer"></app-select-contractor>
                <app-select-contract [(contract)]="consignment.costPayerContract" [contractor]="consignment.costPayer"
                                     [disabled]="!consignment.costPayer"></app-select-contract>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Parties</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-3">
              <app-select-contractor contractorType="Consignor"
                                     [(contractor)]="consignment.consignor"></app-select-contractor>
              <app-select-address [(address)]="consignment.consignorAddress">Select address</app-select-address>
              <app-select-customs [(customs)]="consignment.consignorCustoms"></app-select-customs>

              <input id="sendingDate" type="date" [(ngModel)]="consignment.sendingDate"
                     name="sendingDate" placeholder="Sending date"/>
              <label class="label-border" for="sendingDate">Sending date</label>

            </div>
            <div class="col-md-3">
              <app-select-contractor contractorType="Consignee"
                                     [(contractor)]="consignment.consignee"></app-select-contractor>
              <app-select-address [(address)]="consignment.consigneeAddress">Select address</app-select-address>
            </div>
            <div class="col-md-3">
              <app-select-address [(address)]="consignment.deliveryToCompany">Select address</app-select-address>
            </div>
            <div class="col-md-3">
              <app-select-address [(address)]="consignment.finalDestination">Select address</app-select-address>
              <app-select-customs [(customs)]="consignment.finalDestinationCustoms"></app-select-customs>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <label for="dispatchLocation"><input type="checkbox" id="dispatchLocation"
                                                   [(ngModel)]="dispatchDifferentLocation"
                                                   name="dispatchDifferentLocation"/>Dispatch location different</label>
            </div>
          </div>
          <div class="row" *ngIf="dispatchDifferentLocation">
            <div class="col-md-3">
              <app-select-address [(address)]="consignment.otherConsignorAddress">Select address</app-select-address>
            </div>
          </div>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Additional information</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-3">
              <div class="form-group">
                <mat-form-field><input matInput placeholder="Vehicle registration number" [(ngModel)]="consignment.vehicleRegNum"
                       name="vehicleRegNum"/></mat-form-field>
              </div>
            </div>

            <div class="col-md-3">
              <div class="form-group">
                <app-select-country [(country)]="consignment.vehicleRegCountry"></app-select-country>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-transport-mode [(mode)]="consignment.vehicleModeOfTransport"></app-select-transport-mode>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <div class="form-group">
                <mat-form-field><input matInput placeholder="Active vehicle registration number" [(ngModel)]="consignment.trailerRegNum"
                       name="trailerRegNum"/></mat-form-field>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-country [(country)]="consignment.trailerRegCountry"></app-select-country>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-transport-mode [(mode)]="consignment.trailerModeOfTransport"></app-select-transport-mode>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Terms</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-3">
              <div class="form-group">
                <app-select-delivery-terms [(term)]="consignment.deliveryTerms"></app-select-delivery-terms>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <mat-form-field><input matInput type="text" [(ngModel)]="consignment.deliveryTermsPlaces" placeholder="Places"
                       name="deliveryTermsPlaces"/></mat-form-field>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-release-terms [(term)]="consignment.releaseTerms"></app-select-release-terms>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <mat-form-field><input matInput type="text" placeholder="Places" [(ngModel)]="consignment.releaseTermsPlaces"
                       name="releaseTermsPlaces"/></mat-form-field>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Goods</h3>
        </div>
        <div class="panel-body">
          <div class="good" *ngFor="let row of consignment.goodsInConsignment; let i = index;">
            <div class="row">
              <div class="col-md-11">
                <label class="index">{{ 'Row #' + (i + 1) }}</label>
              </div>
              <div class="col-md-1">
                <a href="javascript:void(0)">
                  <i class="fa fa-times" aria-hidden="true" (click)="deleteRow(i)"></i>
                </a>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <app-select-good [(good)]="row.good" [required]="true"></app-select-good>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <mat-form-field><input matInput size="5" placeholder="Description" [(ngModel)]="row.description" name="row.description" disabled/></mat-form-field>

                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <mat-form-field><input matInput size="5" placeholder="Marks" [(ngModel)]="row.marks" name="row.marks" required/></mat-form-field>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-2">
                <div class="form-group">
                  <mat-form-field><input matInput size="6" class="numeric" placeholder="Places" [(ngModel)]="row.places" name="row.places" (blur)="calculateTotalPlaces()" required/></mat-form-field>

                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <app-select-unit [(unit)]="row.placeType" required></app-select-unit>
                </div>
              </div>
              <div class="col-md-2">
                <div class="form-group">
                  <mat-form-field><input matInput size="6" class="numeric" placeholder="Gross Weight" [(ngModel)]="row.grossWeight" name="row.grossWeight" (blur)="calculateTotalGrossWeight()" required/></mat-form-field>
                </div>
              </div>
              <div class="col-md-2">
                <div class="form-group">
                  <mat-form-field><input matInput size="6" class="numeric" placeholder="Net Weight" [(ngModel)]="row.netWeight" name="row.netWeight" (blur)="calculateTotalNetWeight()"/></mat-form-field>
                </div>
              </div>
              <div class="col-md-2">
                <div class="form-group">
                  <mat-form-field><input matInput size="5" placeholder="Volume" [(ngModel)]="row.volume" name="row.volume" (blur)="calculateTotalVolume()"/></mat-form-field>
                </div>
              </div>
            </div>
          </div>
          <button type="button" (click)="addRow($event)">Add row</button>
          <button type="button" (click)="showGisModal()"
                  [hidden]="consignment.direction !== 'Export' || order == null">Add row from order
          </button>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Totals</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-2">
              <div class="form-group">
                <input size="5" placeholder="Total goods" [ngModel]="consignment.totalRows" name="totalRows" disabled/>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <input size="6" class="numeric" placeholder="Total places" [(ngModel)]="consignment.totalPackages"
                       name="totalPackages" disabled/>
                <label class="label-border">Places</label>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <input size="6" class="numeric" placeholder="Total Gross Weight"
                       [(ngModel)]="consignment.totalGrossWeight" name="totalGrossWeight" disabled/>
                <label class="label-border">Gross Weight</label>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <input size="6" class="numeric" placeholder="Total Net Weight" [(ngModel)]="consignment.totalNetWeight"
                       name="tptaNetWeight" disabled/>
                <label class="label-border">Net Weight</label>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <input size="5" placeholder="Total Volume" [(ngModel)]="consignment.totalVolume" name="totalVolume"
                       disabled/>
                <label class="label-border">Volume</label>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="btns-arrival">
        <input (click)="submit($event)" type="submit" value="Save">
        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
        <input type="submit" value="Cancel">
        <input type="reset" value="Reset">
      </div>
    </form>
  </div>
</div>
