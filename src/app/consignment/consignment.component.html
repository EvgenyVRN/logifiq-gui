<div class="wrapper">

  <ul class="nav nav-tabs nav-justified">
    <li><a href="./consignments">Browse Consignment</a></li>
    <li class="active"><a href="#">Add New Consignment</a></li>
  </ul>

  <div>
    <form name="myForm" class="">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">General Information</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-2">
              <div class="form-group">
                <app-select-cons-direction [(direction)]="consignment.direction"></app-select-cons-direction>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <button [hidden]="consignment.direction !== 'Export'" (click)="showOrderModal()">+Link Order</button>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label [hidden]="consignment.direction !== 'Export'">Order Id: {{ order == null ? '' :
                 order.id }}</label>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-contractor [(contractor)]="consignment.goodsHolder" contractorType="Goods holder"
                                       [hidden]="consignment.direction === 'Import' || consignment.direction == ''"></app-select-contractor>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-contractor contractorType="Cost payer"
                                       [(contractor)]="consignment.costPayer"></app-select-contractor>
                <app-select-contract [(contract)]="consignment.costPayerContract" [contractor]="consignment.costPayer"
                                     [disabled]="!consignment.costPayer"></app-select-contract>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Parties</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-3">
              <app-select-contractor contractorType="Consignor"
                                     [(contractor)]="consignment.consignor"></app-select-contractor>
              <app-select-address [(address)]="consignment.consignorAddress">Select address</app-select-address>
              <app-select-customs [(customs)]="consignment.consignorCustoms"></app-select-customs>

              <div class="ui-float-label">
                  <p-calendar id="sendingDate" [(ngModel)]="consignment.sendingDate" name="sending date" [showIcon]="true" [monthNavigator]="true" [yearNavigator]="true" yearRange="2000:2030"></p-calendar>
                  <label for="sendingDate">Sending date</label>
              </div>

            </div>
            <div class="col-md-3">
              <app-select-contractor contractorType="Consignee"
                                     [(contractor)]="consignment.consignee"></app-select-contractor>
              <app-select-address [(address)]="consignment.consigneeAddress">Select address</app-select-address>
            </div>
            <div class="col-md-3">
              <app-select-address [(address)]="consignment.deliveryToCompany">Select address</app-select-address>
            </div>
            <div class="col-md-3">
              <app-select-address [(address)]="consignment.finalDestination">Select address</app-select-address>
              <app-select-customs [(customs)]="consignment.finalDestinationCustoms"></app-select-customs>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <p-checkbox name="first" value="Dispatch different location" label="Dispatch location different" [(ngModel)]="dld"></p-checkbox>
            </div>
          </div>
          <div class="row" *ngIf="dld">
            <div class="col-md-3">
              <app-select-address [(address)]="consignment.otherConsignorAddress">Select address</app-select-address>
            </div>
          </div>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Additional information</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-3">
              <div class="form-group ui-float-label">
                <input pInputText id="vrn" [(ngModel)]="consignment.vehicleRegNum" name="vehicleRegNum"/>
                <label for="vrn">Vehicle registration number</label>
              </div>
            </div>

            <div class="col-md-3">
              <div class="form-group">
                <app-select-country [(country)]="consignment.vehicleRegCountry"></app-select-country>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-transport-mode [(mode)]="consignment.vehicleModeOfTransport"></app-select-transport-mode>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3">
              <div class="form-group ui-float-label">
                <input pInputText id="avrn" [(ngModel)]="consignment.trailerRegNum" name="trailerRegNum"/>
                <label for="avrn">Active vehicle registration number</label>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-country [(country)]="consignment.trailerRegCountry"></app-select-country>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-transport-mode [(mode)]="consignment.trailerModeOfTransport"></app-select-transport-mode>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Terms</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-3">
              <div class="form-group">
                <app-select-delivery-terms [(term)]="consignment.deliveryTerms"></app-select-delivery-terms>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group ui-float-label">
                <input pInputText [(ngModel)]="consignment.deliveryTermsPlaces" id="dvt" name="deliveryTermsPlaces"/>
                <label for="dvt">Places</label>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <app-select-release-terms [(term)]="consignment.releaseTerms"></app-select-release-terms>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group ui-float-label">
                <input matInput id="rtp" [(ngModel)]="consignment.releaseTermsPlaces" name="releaseTermsPlaces"/>
                <label for="rtp">Places</label>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Goods</h3>
        </div>
        <div class="panel-body">
          <div class="good" *ngFor="let row of consignment.goodsInConsignment; let i = index;">
            <div class="row">
              <div class="col-md-11">
                <label class="index">{{ 'Row #' + (i + 1) }}</label>
              </div>
              <div class="col-md-1">
                <a href="javascript:void(0)">
                  <i class="fa fa-times" aria-hidden="true" (click)="deleteRow(i)"></i>
                </a>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <app-select-good [(good)]="row.good" [required]="true"></app-select-good>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group ui-float-label">
                  <input pInputText id="desc" [(ngModel)]="row.description" name="row.description" disabled/>
                  <label for="desc">Description</label>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group ui-float-label">
                  <input pInputText id="marks" [(ngModel)]="row.marks" name="row.marks" required/>
                  <label for="marks">Marks</label>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-2">
                <div class="form-group ui-float-label">
                  <input pInputText class="numeric" id="goodPlaces" [(ngModel)]="row.places" name="row.places" (blur)="calculateTotalPlaces()" required/>
                  <label for="goodPlaces">Places</label>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <app-select-unit [(unit)]="row.placeType" [required]="true"></app-select-unit>
                </div>
              </div>
              <div class="col-md-2">
                <div class="form-group ui-float-label">
                  <input  pInputText class="numeric" id="grossWeight" [(ngModel)]="row.grossWeight" name="row.grossWeight" (blur)="calculateTotalGrossWeight()" [required]="true"/>
                  <label for="grossWeight">Gross weight</label>
                </div>
              </div>
              <div class="col-md-2">
                <div class="form-group ui-float-label">
                  <input pInputText class="numeric" id="netWeight" [(ngModel)]="row.netWeight" name="row.netWeight" (blur)="calculateTotalNetWeight()"/>
                  <label for="netWeight">Net weight</label>
                </div>
              </div>
              <div class="col-md-2">
                <div class="form-group ui-float-label">
                  <input pInputText id="volume" [(ngModel)]="row.volume" name="row.volume" (blur)="calculateTotalVolume()"/>
                  <label for="volume">Volume</label>
                </div>
              </div>
            </div>
          </div>
          <button type="button" (click)="addRow($event)">Add row</button>
          <button type="button" (click)="showGisModal()"
                  [hidden]="consignment.direction !== 'Export' || order == null">Add row from order
          </button>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Totals</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-2">
              <div class="form-group ui-float-label">
                <input pInputText size="5" id="goodsTotal" [ngModel]="consignment.totalRows" name="totalRows" disabled/>
                <label for="goodsTotal">Total goods</label>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group ui-float-label">
                <input pInputText class="numeric" id="placesTotal" [(ngModel)]="consignment.totalPackages" name="totalPackages" disabled/>
                <label for="placesTotal">Total places</label>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group ui-float-label">
                <input pInputText class="numeric" id="grossWeightTotal" [(ngModel)]="consignment.totalGrossWeight" name="totalGrossWeight" disabled/>
                <label for="grossWeightTotal">Total gross weight</label>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group ui-float-label">
                <input pInputText class="numeric" id="netWeightTotal" [(ngModel)]="consignment.totalNetWeight" name="tptaNetWeight" disabled/>
                <label for="netWeightTotal">Total new weight</label>
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group ui-float-label">
                <input pInputText id="volumeTotal" [(ngModel)]="consignment.totalVolume" name="totalVolume" disabled/>
                <label for="volumeTotal">Total volume</label>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="btns-arrival">
        <input (click)="submit($event)" type="submit" value="Save">
        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
        <input type="submit" value="Cancel">
        <input type="reset" value="Reset">
      </div>
    </form>
  </div>
</div>
